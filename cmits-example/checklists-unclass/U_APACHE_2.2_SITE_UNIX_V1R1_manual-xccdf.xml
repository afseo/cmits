<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" id="APACHE_SITE_2.2_UNIX" xml:lang="en" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2011-12-12">draft</status><title>APACHE SITE 2.2 for Unix</title><description>All directives specified in this STIG must be specifically set (i.e. the server is not allowed to revert to programmed defaults for these directives).

Included files should be reviewed if they are used.  Procedures for reviewing included files are included in the overview document.

The use of .htaccess files are not authorized for use according to the STIG.  However, if they are used, there are procedures for reviewing them in the overview document.

The Web Policy STIG should be used in addition to the Apache Site and Server STIGs in order to do a comprehensive web server review.  
</description><notice id="terms-of-use" xml:lang="en"></notice><reference href="http://iase.disa.mil"><dc:publisher>DISA, Field Security Operations</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 1 Benchmark Date: 23 Nov 2011</plain-text><version>1</version><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-2226" selected="true" /><select idref="V-2227" selected="true" /><select idref="V-2228" selected="true" /><select idref="V-2240" selected="true" /><select idref="V-2245" selected="true" /><select idref="V-2249" selected="true" /><select idref="V-2250" selected="true" /><select idref="V-2252" selected="true" /><select idref="V-2254" selected="true" /><select idref="V-2258" selected="true" /><select idref="V-2260" selected="true" /><select idref="V-2262" selected="true" /><select idref="V-2263" selected="true" /><select idref="V-2265" selected="true" /><select idref="V-2270" selected="true" /><select idref="V-2272" selected="true" /><select idref="V-3333" selected="true" /><select idref="V-6373" selected="true" /><select idref="V-6531" selected="true" /><select idref="V-13686" selected="true" /><select idref="V-13687" selected="true" /><select idref="V-13688" selected="true" /><select idref="V-13689" selected="true" /><select idref="V-13694" selected="true" /><select idref="V-15334" selected="true" /><select idref="V-26279" selected="true" /><select idref="V-26280" selected="true" /><select idref="V-26281" selected="true" /><select idref="V-26282" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-2226" selected="true" /><select idref="V-2227" selected="true" /><select idref="V-2228" selected="true" /><select idref="V-2240" selected="true" /><select idref="V-2245" selected="true" /><select idref="V-2249" selected="true" /><select idref="V-2250" selected="true" /><select idref="V-2252" selected="true" /><select idref="V-2254" selected="true" /><select idref="V-2258" selected="true" /><select idref="V-2260" selected="true" /><select idref="V-2262" selected="true" /><select idref="V-2263" selected="true" /><select idref="V-2265" selected="true" /><select idref="V-2270" selected="true" /><select idref="V-2272" selected="true" /><select idref="V-3333" selected="true" /><select idref="V-6373" selected="true" /><select idref="V-6531" selected="true" /><select idref="V-13686" selected="true" /><select idref="V-13687" selected="true" /><select idref="V-13688" selected="true" /><select idref="V-13689" selected="true" /><select idref="V-13694" selected="true" /><select idref="V-15334" selected="true" /><select idref="V-26279" selected="true" /><select idref="V-26280" selected="true" /><select idref="V-26281" selected="true" /><select idref="V-26282" selected="true" /></Profile><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-2226" selected="true" /><select idref="V-2227" selected="true" /><select idref="V-2228" selected="true" /><select idref="V-2240" selected="true" /><select idref="V-2245" selected="true" /><select idref="V-2249" selected="true" /><select idref="V-2250" selected="true" /><select idref="V-2252" selected="true" /><select idref="V-2254" selected="true" /><select idref="V-2258" selected="true" /><select idref="V-2260" selected="true" /><select idref="V-2262" selected="true" /><select idref="V-2263" selected="true" /><select idref="V-2265" selected="true" /><select idref="V-2270" selected="true" /><select idref="V-2272" selected="true" /><select idref="V-3333" selected="true" /><select idref="V-6373" selected="true" /><select idref="V-6531" selected="true" /><select idref="V-13686" selected="true" /><select idref="V-13687" selected="true" /><select idref="V-13688" selected="true" /><select idref="V-13689" selected="true" /><select idref="V-13694" selected="true" /><select idref="V-15334" selected="true" /><select idref="V-26279" selected="true" /><select idref="V-26280" selected="true" /><select idref="V-26281" selected="true" /><select idref="V-26282" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-2226" selected="true" /><select idref="V-2227" selected="true" /><select idref="V-2228" selected="true" /><select idref="V-2240" selected="true" /><select idref="V-2245" selected="true" /><select idref="V-2249" selected="true" /><select idref="V-2250" selected="true" /><select idref="V-2252" selected="true" /><select idref="V-2254" selected="true" /><select idref="V-2258" selected="true" /><select idref="V-2260" selected="true" /><select idref="V-2262" selected="true" /><select idref="V-2263" selected="true" /><select idref="V-2265" selected="true" /><select idref="V-2270" selected="true" /><select idref="V-2272" selected="true" /><select idref="V-3333" selected="true" /><select idref="V-6373" selected="true" /><select idref="V-6531" selected="true" /><select idref="V-13686" selected="true" /><select idref="V-13687" selected="true" /><select idref="V-13688" selected="true" /><select idref="V-13689" selected="true" /><select idref="V-13694" selected="true" /><select idref="V-15334" selected="true" /><select idref="V-26279" selected="true" /><select idref="V-26280" selected="true" /><select idref="V-26281" selected="true" /><select idref="V-26282" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-2226" selected="true" /><select idref="V-2227" selected="true" /><select idref="V-2228" selected="true" /><select idref="V-2240" selected="true" /><select idref="V-2245" selected="true" /><select idref="V-2249" selected="true" /><select idref="V-2250" selected="true" /><select idref="V-2252" selected="true" /><select idref="V-2254" selected="true" /><select idref="V-2258" selected="true" /><select idref="V-2260" selected="true" /><select idref="V-2262" selected="true" /><select idref="V-2263" selected="true" /><select idref="V-2265" selected="true" /><select idref="V-2270" selected="true" /><select idref="V-2272" selected="true" /><select idref="V-3333" selected="true" /><select idref="V-6373" selected="true" /><select idref="V-6531" selected="true" /><select idref="V-13686" selected="true" /><select idref="V-13687" selected="true" /><select idref="V-13688" selected="true" /><select idref="V-13689" selected="true" /><select idref="V-13694" selected="true" /><select idref="V-15334" selected="true" /><select idref="V-26279" selected="true" /><select idref="V-26280" selected="true" /><select idref="V-26281" selected="true" /><select idref="V-26282" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-2226" selected="true" /><select idref="V-2227" selected="true" /><select idref="V-2228" selected="true" /><select idref="V-2240" selected="true" /><select idref="V-2245" selected="true" /><select idref="V-2249" selected="true" /><select idref="V-2250" selected="true" /><select idref="V-2252" selected="true" /><select idref="V-2254" selected="true" /><select idref="V-2258" selected="true" /><select idref="V-2260" selected="true" /><select idref="V-2262" selected="true" /><select idref="V-2263" selected="true" /><select idref="V-2265" selected="true" /><select idref="V-2270" selected="true" /><select idref="V-2272" selected="true" /><select idref="V-3333" selected="true" /><select idref="V-6373" selected="true" /><select idref="V-6531" selected="true" /><select idref="V-13686" selected="true" /><select idref="V-13687" selected="true" /><select idref="V-13688" selected="true" /><select idref="V-13689" selected="true" /><select idref="V-13694" selected="true" /><select idref="V-15334" selected="true" /><select idref="V-26279" selected="true" /><select idref="V-26280" selected="true" /><select idref="V-26281" selected="true" /><select idref="V-26282" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-2226" selected="true" /><select idref="V-2227" selected="true" /><select idref="V-2228" selected="true" /><select idref="V-2240" selected="true" /><select idref="V-2245" selected="true" /><select idref="V-2249" selected="true" /><select idref="V-2250" selected="true" /><select idref="V-2252" selected="true" /><select idref="V-2254" selected="true" /><select idref="V-2258" selected="true" /><select idref="V-2260" selected="true" /><select idref="V-2262" selected="true" /><select idref="V-2263" selected="true" /><select idref="V-2265" selected="true" /><select idref="V-2270" selected="true" /><select idref="V-2272" selected="true" /><select idref="V-3333" selected="true" /><select idref="V-6373" selected="true" /><select idref="V-6531" selected="true" /><select idref="V-13686" selected="true" /><select idref="V-13687" selected="true" /><select idref="V-13688" selected="true" /><select idref="V-13689" selected="true" /><select idref="V-13694" selected="true" /><select idref="V-15334" selected="true" /><select idref="V-26279" selected="true" /><select idref="V-26280" selected="true" /><select idref="V-26281" selected="true" /><select idref="V-26282" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-2226" selected="true" /><select idref="V-2227" selected="true" /><select idref="V-2228" selected="true" /><select idref="V-2240" selected="true" /><select idref="V-2245" selected="true" /><select idref="V-2249" selected="true" /><select idref="V-2250" selected="true" /><select idref="V-2252" selected="true" /><select idref="V-2254" selected="true" /><select idref="V-2258" selected="true" /><select idref="V-2260" selected="true" /><select idref="V-2262" selected="true" /><select idref="V-2263" selected="true" /><select idref="V-2265" selected="true" /><select idref="V-2270" selected="true" /><select idref="V-2272" selected="true" /><select idref="V-3333" selected="true" /><select idref="V-6373" selected="true" /><select idref="V-6531" selected="true" /><select idref="V-13686" selected="true" /><select idref="V-13687" selected="true" /><select idref="V-13688" selected="true" /><select idref="V-13689" selected="true" /><select idref="V-13694" selected="true" /><select idref="V-15334" selected="true" /><select idref="V-26279" selected="true" /><select idref="V-26280" selected="true" /><select idref="V-26281" selected="true" /><select idref="V-26282" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-2226" selected="true" /><select idref="V-2227" selected="true" /><select idref="V-2228" selected="true" /><select idref="V-2240" selected="true" /><select idref="V-2245" selected="true" /><select idref="V-2249" selected="true" /><select idref="V-2250" selected="true" /><select idref="V-2252" selected="true" /><select idref="V-2254" selected="true" /><select idref="V-2258" selected="true" /><select idref="V-2260" selected="true" /><select idref="V-2262" selected="true" /><select idref="V-2263" selected="true" /><select idref="V-2265" selected="true" /><select idref="V-2270" selected="true" /><select idref="V-2272" selected="true" /><select idref="V-3333" selected="true" /><select idref="V-6373" selected="true" /><select idref="V-6531" selected="true" /><select idref="V-13686" selected="true" /><select idref="V-13687" selected="true" /><select idref="V-13688" selected="true" /><select idref="V-13689" selected="true" /><select idref="V-13694" selected="true" /><select idref="V-15334" selected="true" /><select idref="V-26279" selected="true" /><select idref="V-26280" selected="true" /><select idref="V-26281" selected="true" /><select idref="V-26282" selected="true" /></Profile><Group id="V-2226"><title>WG210</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33022r1_rule" severity="medium" weight="10.0"><version>WG210 A22</version><title>Web content directories must not be anonymously shared.</title><description>&lt;VulnDiscussion&gt;Sharing web content is a security risk when a web server is involved. Users accessing the share anonymously could experience privileged access to the content of such directories. Network sharable directories expose those directories and their contents to unnecessary access. Any unnecessary exposure increases the risk that someone could exploit that access and either compromises the web content or cause web server performance problems.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECCD-1, ECCD-2&lt;/IAControls&gt;</description><fixtext fixref="F-2275r3_fix">Remove the shares from the applicable directories.</fixtext><fix id="F-2275r3_fix" /><check system="C-33704r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>To view the DocumentRoot enter the following command: 

grep "DocumentRoot" /usr/local/apache2/conf/httpd.conf 

To view the ServerRoot enter the following command: 

grep "serverRoot" /usr/local/apache2/conf/httpd.conf 

Note the location following the DocumentRoot and ServerRoot directives. 

Enter the following commands to determine if file sharing is running: 

ps -ef | grep nfs, ps -ef | grep smb 

If results are returned, determine the shares and confirm they are not in the same directory as listed above, If they are, this is a finding. </check-content></check></Rule></Group><Group id="V-2227"><title>WG360</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-30576r2_rule" severity="high" weight="10.0"><version>WG360 A22</version><title>Symbolic links must not be used in the web content directory tree.</title><description>&lt;VulnDiscussion&gt;A symbolic link allows a file or a directory to be referenced using a symbolic name raising a potential hazard if symbolic linkage is made to a sensitive area.

When web scripts are executed and symbolic links are allowed, the web user could be allowed to access locations on the web server that are outside the scope of the web document root or home directory.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;If symbolic links are found in the web content directory tree, the target file or directory is outside of the web content directory tree, and file permissions allow the web user write authority, then the severity level will remain at CAT 1. 

If symbolic links are found in the web content directory tree, the target file or directory is outside of the web content directory tree, and file permissions allow the web user any authority less than write, then the severity level will be downgraded to CAT 2. 

If symbolic links are found in the web content directory tree, the target file or directory is not outside of the web content directory tree, and file permissions allow the web user write authority, then the severity level will remain at CAT 1. 

If symbolic links are found in the web content directory tree, the target file or directory is not outside of the web content directory tree, and file permissions allow the web user any authority less than write, then the severity level will be downgraded to CAT 3.
&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-26783r1_fix">Disable symbolic links.</fixtext><fix id="F-26783r1_fix" /><check system="C-31108r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Locate the directories containing the web content, (i.e., /usr/local/apache/htdocs). 

Use ls –al. 

An entry, such as the following, would indicate the presence and use of symbolic links:

lr-xr—r--  4000 wwwusr  wwwgrp	2345	Apr 15	  data  -&gt; /usr/local/apache/htdocs

Such a result found in a web document directory is a finding. Additional Apache configuration check in the httpd.conf file:

&lt;Directory /[website root dir]&gt;
    Options FollowSymLinks
    AllowOverride None
&lt;/Directory&gt;

The above configuration is incorrect and is a finding. The correct configuration is:

&lt;Directory /[website root dir]&gt;
    Options SymLinksIfOwnerMatch
    AllowOverride None
&lt;/Directory&gt;

Finally, the target file or directory must be owned by the same owner as the link, which should be a privileged account with access to the web content.
</check-content></check></Rule></Group><Group id="V-2228"><title>WG400</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-6928r4_rule" severity="medium" weight="10.0"><version>WG400 A22</version><title>All interactive programs (CGI) must be placed in a designated directory with appropriate permissions.</title><description>&lt;VulnDiscussion&gt;CGI scripts represents one of the most common and exploitable means of compromising a web server. By definition, CGI are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not otherwise limited unless the SA or Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs and use the network. CGI programs can be written in any available programming language. C, PERL, PHP, Javascript, VBScript and shell (sh, ksh, bash) are popular choices.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;DCPA-1, ECLP-1&lt;/IAControls&gt;</description><fixtext fixref="F-2277r2_fix">Ensure the CGI (or equivalent i.e. scripts) directory has access controls IAW the WEB Services STIG.</fixtext><fix id="F-2277r2_fix" /><check system="C-2786r4_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>To preclude access to the servers root directory, ensure the following directive is in the httpd.conf file. This entry will also stop users from setting up .htaccess files which can override security features configured in httpd.conf.

&lt;DIRECTORY /[website root dir]&gt;
AllowOverride None
&lt;/DIRECTORY&gt;

If the AllowOverride None is not set, this is a finding.
</check-content></check></Rule></Group><Group id="V-2240"><title>WG110</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33018r1_rule" severity="medium" weight="10.0"><version>WG110 A22</version><title>The number of allowed simultaneous requests must be set.</title><description>&lt;VulnDiscussion&gt;Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a web site, facilitating a denial of service attack. Mitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests per IP address and may include, where feasible, limiting parameter values associated with keepalive, (i.e., a parameter used to limit the amount of time a connection may be inactive).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-29334r1_fix">Edit the httpd.conf file and set the MaxKeepAliveRequests directive to 100 or greater.</fixtext><fix id="F-29334r1_fix" /><check system="C-33700r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>To view the MaxKeepAliveRequests value, enter the following command: 

grep "MaxKeepAliveRequests" /usr/local/apache2/conf/httpd.conf 

If the returned value of MaxKeepAliveRequests is not set to 100 or greater, this is a finding. 
</check-content></check></Rule></Group><Group id="V-2245"><title>WG170</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33020r1_rule" severity="low" weight="10.0"><version>WG170 A22</version><title>Each readable web document directory must contain either a default, home, index, or equivalent file.</title><description>&lt;VulnDiscussion&gt;The goal is to completely control the web users experience in navigating any portion of the web document root directories. Ensuring all web content directories have at least the equivalent of an index.html file is a significant factor to accomplish this end. Also, enumeration techniques, such as URL parameter manipulation, rely upon being able to obtain information about the web server’s directory structure by locating directories with default pages. This practice helps ensure that the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-29336r1_fix">Add a default document to the applicable directories.</fixtext><fix id="F-29336r1_fix" /><check system="C-33702r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>To view the DocumentRoot value enter the following command: 
awk '{print $1,$2,$3}' /usr/local/apache2/conf/httpd.conf|grep -i DocumentRoot|grep -v '^#'
Note each location following the DocumentRoot string, this is the configured path(s) to the document root directory(s). 
To view a list of the directories and sub-directories and the file index.html, from each stated DocumentRoot location enter the following commands:
find . -type d
find . -type f -name index.html
Review the results for each document root directory and it's subdirectories. If a directory does not contain an index.html or equivalent default document, this is a finding.
</check-content></check></Rule></Group><Group id="V-2249"><title>WG230</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33023r1_rule" severity="high" weight="10.0"><version>WG230 A22</version><title>Web server administration must be performed over a secure path or at the local console.</title><description>&lt;VulnDiscussion&gt;Logging in to a web server via an unencrypted protocol or service, to perform updates and maintenance, is a major risk. In all such cases, user accounts and passwords are passed in the plain text. An encrypted protocol or service must be used for remote access for remote access to web administration tasks. Another alternative is to administer the web server from the console, which implies physical access to the server.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;EBRU-1&lt;/IAControls&gt;</description><fixtext fixref="F-2298r3_fix">Ensure the web server's administration is only performed over a secure path.</fixtext><fix id="F-2298r3_fix" /><check system="C-33705r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>If web administration is performed remotely the following checks will apply:

If administration of the server is performed remotely, it will only be performed securely by system administrators.

If web site administration or web application administration has been delegated, those users will be documented and approved by the IAO.

Remote administration must be in compliance with any requirements contained within the Unix Server STIGs, and any applicable network STIGs.

Remote administration of any kind will be restricted to documented and authorized personnel.

All users performing remote administration must be authenticated.

All remote sessions will be encrypted and they will utilize TLS 1.0.
</check-content></check></Rule></Group><Group id="V-2250"><title>WG240</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33025r1_rule" severity="medium" weight="10.0"><version>WG240 A22</version><title>Logs of web server access and errors must be established and maintained</title><description>&lt;VulnDiscussion&gt;A major tool in exploring the web site use, attempted use, unusual conditions, and problems are reported in the access and error logs. In the event of a security incident, these logs can provide the SA and the web manager with valuable information. Without these log files, SAs and web managers are seriously hindered in their efforts to respond appropriately to suspicious or criminal actions targeted at the web site.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAT-1, ECAT-2&lt;/IAControls&gt;</description><fixtext fixref="F-29339r1_fix">Edit the httpd.conf file and add the following module to configure logging.

"log_config_module"</fixtext><fix id="F-29339r1_fix" /><check system="C-33707r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>To view a list of loaded modules enter the following command: 

/usr/local/apache2/bin/httpd -M 

If the following module is not found, this is a finding: "log_config_module"</check-content></check></Rule></Group><Group id="V-2252"><title>WG250</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33033r1_rule" severity="medium" weight="10.0"><version>WG250 A22</version><title>Log file access must be restricted to System Administrators, Web Administrators or Auditors.</title><description>&lt;VulnDiscussion&gt;A major tool in exploring the web site use, attempted use, unusual conditions, and problems are the access and error logs. In the event of a security incident, these logs can provide the SA and the web manager with valuable information. To ensure the integrity of the log files and protect the SA and the web manager from a conflict of interest related to the maintenance of these files, only the members of the Auditors group will be granted permissions to move, copy, and delete these files in the course of their duties related to the archiving of these files.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECTP-1&lt;/IAControls&gt;</description><fixtext fixref="F-29348r1_fix">Use the chmod command to set the appropriate file permissions on the log files.</fixtext><fix id="F-29348r1_fix" /><check system="C-33716r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Enter the following command to determine the directory the log files are located in:

grep "ErrorLog" /usr/local/apache2/conf/httpd.conf

grep "CustomLog" /usr/local/apache2/conf/httpd.conf

Verify the permission of the ErrorLog &amp; CustomLog files by entering the following command:

ls -al /usr/local/apache2/logs/*.log 

Unix file permissions should be 640 or less for all web log files if not, this is a finding.  
</check-content></check></Rule></Group><Group id="V-2254"><title>WG260</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-32830r1_rule" severity="medium" weight="10.0"><version>WG260 A22</version><title>Only web sites that have been fully reviewed and tested must exist on a production web server.</title><description>&lt;VulnDiscussion&gt;In the case of a production web server, areas for content development and testing will not exist, as this type of content is only permissible on a development web site. The process of developing on a functional production web site entails a degree of trial and error and repeated testing. This process is often accomplished in an environment where debugging, sequencing, and formatting of content are the main goals. The opportunity for a malicious user to obtain files that reveal business logic and login schemes is high in this situation. The existence of such immature content on a web server represents a significant security risk that is totally avoidable.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-29340r1_fix">The presences of portions of the web site that proclaim Under Construction or Under Development are clear indications that a production web server is being used for development. The web administrator will ensure that all pages that are in development are not installed on a production web server.</fixtext><fix id="F-29340r1_fix" /><check system="C-33708r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Query the IAO, the SA, and the web administrator to find out if development web sites are being housed on production web servers. 

Proposed Questions:
Do you have development sites on your production web server?
What is your process to get development web sites / content posted to the production server?
Do you use under construction notices on production web pages?

The reviewer can also do a manual check or perform a navigation of the web site via a browser could be used to confirm the information provided from interviewing the web staff. Graphics or texts which proclaim Under Construction or Under Development are frequently used to mark folders or directories in that status.

If Under Construction or Under Development web content is discovered on the production web server, this is a finding.</check-content></check></Rule></Group><Group id="V-2258"><title>WG290</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33027r1_rule" severity="high" weight="10.0"><version>WG290 A22</version><title>Web client access to the content directories must be restricted to read and execute.</title><description>&lt;VulnDiscussion&gt;Excessive permissions for the anonymous web user account are one of the most common faults contributing to the compromise of a web server. If this user is able to upload and execute files on the web server, the organization or owner of the server will no longer have control of the asset.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECLP-1&lt;/IAControls&gt;</description><fixtext fixref="F-29342r1_fix">Assign the appropriate permissions to the applicable directories and files using the chmod command.</fixtext><fix id="F-29342r1_fix" /><check system="C-33710r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>To view the value of Alias enter the following command:  

grep "Alias" /usr/local/apache2/conf/httpd.conf  

Alias
ScriptAlias
ScriptAliasMatch

Review the results to determine the location of the files listed above. 

Enter the following command to determine the permissions of the above file:   

ls -Ll /file-path

The only accounts listed should be the web administrator, developers, and the account assigned to run the apache server service.  
If accounts that don’t need access to these directories are listed, this is a finding. 
If the permissions assigned to the account for the Apache web server service is greater than Read &amp; Execute (R_E), this is a finding.</check-content></check></Rule></Group><Group id="V-2260"><title>WG310</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33028r1_rule" severity="low" weight="10.0"><version>WG310 A22</version><title>A private web server must not respond to requests from public search engines.</title><description>&lt;VulnDiscussion&gt;Search engines are constantly at work on the Internet. Search engines are augmented by agents, often referred to as spiders or bots, which endeavor to capture and catalog web site content. In turn, these search engines make the content they obtain and catalog available to any public web user. Such information in the public domain defeats the purpose of a Limited or Certificate-based web server, provides information to those not authorized access to the web site, and could provide clues of the site’s architecture to malicious parties.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECLP-1&lt;/IAControls&gt;</description><fixtext fixref="F-29343r1_fix">Establish a means to restrict search engines on the private web site.
</fixtext><fix id="F-29343r1_fix" /><check system="C-33711r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Note: Additional restrictions can be stated in the robots.txt file. The below example will disallow access to all directories in the document root directory. If the robots.txt doesn’t have “User-agent” or “Disallow” statements set, this is a finding.
Query the Web Administrator to determine what type of restriction from public search engines is in place.

If robots.txt files are used, locate the Apache httpd.conf file.

If unable to locate the file, perform a search of the system to find the location of the file.

Open the httpd.conf file with an editor such as Notepad, and search for the following uncommented directives : DocumentRoot &amp; Alias

Navigate to the location(s) specified in the Include statement(s), and review each file for the following uncommented directives: DocumentRoot &amp; Alias

At the top level of the directories identified after the enabled DocumentRoot &amp; Alias directives, a “robots.txt” file should exist. If the file does not exist, this is a finding. For any robots.txt files that do exist, open them in a text editor (i.e. notepad) and ensure they contain the following text:

User-agent: *
Disallow: /

If no means of restriction is in place (e.g. userid and password, domain or IP restriction, PKI), or a robots.txt file is not in use, this is finding.
</check-content></check></Rule></Group><Group id="V-2262"><title>WG340</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33029r1_rule" severity="medium" weight="10.0"><version>WG340 A22</version><title>A private web server must utilize TLS v 1.0 or greater.</title><description>&lt;VulnDiscussion&gt;Transport Layer Security (TLS) encryption is a required security setting for a private web server. This check precludes the possibility that a valid certificate has been obtained, but TLS has not been activated or is not being used. Transactions encrypted with trusted certificates are necessary when the information being transferred is not intended to be accessed by all parties on the network.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-29344r1_fix">Edit the httpd.conf file and set the SSLProtocol to TLSv1 and the SSLEngine to On.</fixtext><fix id="F-29344r1_fix" /><check system="C-33712r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Enter the following command:

/usr/local/apache2/bin/httpd –M |grep -i ssl

This will provide a list of all the loaded modules. Verify that the “ssl_module” is loaded. If this module is not found, determine if it is loaded as a dynamic module. Enter the following command:

grep ^LoadModule /usr/local/apache2/conf/httpd.conf

If the SSL module is not enabled this is a finding. 

After determining that the ssl module is active, enter the following command to review the SSL directives.

grep -i ssl /usr/local/apache2/conf/httpd.conf

Review the SSL section(s) of the httpd.conf file, all enabled SSLProtocol directives must be set to “TLSv1” or this is a finding. 

All enabled SSLEngine directive must be set to “on”, if not this is a finding.
  
NOTE: In some cases web servers are configured in an environment to support load balancing. This configuration most likely utilizes a content switch to control traffic to the various web servers. In this situation, the TLS certificate for the web sites may be installed on the content switch vs the individual web sites. This solution is acceptable as long as the web servers are isolated from the general population LAN. Users should not have the ability to bypass the content switch to access the web sites.
</check-content></check></Rule></Group><Group id="V-2263"><title>WG350</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33031r1_rule" severity="medium" weight="10.0"><version>WG350 A22</version><title>A private web server will have a valid DoD server certificate.</title><description>&lt;VulnDiscussion&gt;This check verifies that DoD is a hosted web site's CA. The certificate is actually a DoD-issued server certificate used by the organization being reviewed. This is used to verify the authenticity of the web site to the user. If the certificate is not for the server (Certificate belongs to), if the certificate is not issued by DoD (Certificate was issued by), or if the current date is not included in the valid date (Certificate is valid from), then there is no assurance that the use of the certificate is valid. The entire purpose of using a certificate is, therefore, compromised.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;IATS-1, IATS-2&lt;/IAControls&gt;</description><fixtext fixref="F-29346r1_fix">Configure the private web site to use a valid DoD certificate.</fixtext><fix id="F-29346r1_fix" /><check system="C-33714r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Open browser window and browse to the appropriate site. Before entry to the site, you should be presented with the server's DoD PKI credentials. Review these credentials for authenticity.

Find an entry which cites:

Issuer:
CN = DOD CLASS 3 CA-3
OU = PKI
OU = DoD
O = U.S. Government
C = US

If the server is running as a public web server, this finding should be Not Applicable.

NOTE: In some cases, the web servers are configured in an environment to support load balancing. This configuration most likely utilizes a content switch to control traffic to the various web servers. In this situation, the SSL certificate for the web sites may be installed on the content switch vs. the individual web sites. This solution is acceptable as long as the web servers are isolated from the general population LAN. Users should not have the ability to bypass the content switch to access the web sites.
</check-content></check></Rule></Group><Group id="V-2265"><title>WG490</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33032r1_rule" severity="low" weight="10.0"><version>WG490 A22</version><title>Java software on production web servers must be limited to class files and the JAVA virtual machine.</title><description>&lt;VulnDiscussion&gt;From the source code in a .java or a .jpp file, the Java compiler produces a binary file with an extension of .class. The .java or .jpp file would, therefore, reveal sensitive information regarding an application’s logic and permissions to resources on the server. By contrast, the .class file, because it is intended to be machine independent, is referred to as bytecode. Bytecodes are run by the Java Virtual Machine (JVM), or the Java Runtime Environment (JRE), via a browser configured to permit Java code.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-29347r1_fix">Remove the unnecessary files from the web server.</fixtext><fix id="F-29347r1_fix" /><check system="C-33715r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Enter the commands: 

find / -name *.java 

find / -name *.jpp 

If either file type is found, this is a finding.</check-content></check></Rule></Group><Group id="V-2270"><title>WG430</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-36641r1_rule" severity="medium" weight="10.0"><version>WG430 A22</version><title>Anonymous FTP user access to interactive scripts is prohibited.</title><description>&lt;VulnDiscussion&gt;The directories containing the CGI scripts, such as PERL, must not be accessible to anonymous users via FTP. This applies to all directories that contain scripts that can dynamically produce web pages in an interactive manner (i.e., scripts based upon user-provided input). Such scripts contain information that could be used to compromise a web service, access system resources, or deface a web site.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECCD-1, ECCD-2&lt;/IAControls&gt;</description><fixtext fixref="F-26838r2_fix">If the CGI, the cgi-bin, or the cgi-shl directories can be accessed via FTP by any group or user that does not require access, remove permissions to such directories for all but the web administrators and the SAs. Ensure that any such access employs an encrypted connection. </fixtext><fix id="F-26838r2_fix" /><check system="C-29981r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Locate the directories containing the CGI scripts. These directories should be language-specific (e.g., PERL, ASP, JS, JSP, etc.). 

Using ls –al, examine the file permissions on the CGI, the cgi-bin, and the cgi-shl directories.

Anonymous FTP users must not have access to these directories.

If the CGI, the cgi-bin, or the cgi-shl directories can be accessed by any group that does not require access, this is a finding.
</check-content></check></Rule></Group><Group id="V-2272"><title>WG460</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-6932r5_rule" severity="medium" weight="10.0"><version>WG460 A22</version><title>PERL scripts must use the TAINT option.</title><description>&lt;VulnDiscussion&gt;PERL (Practical Extraction and Report Language) is an interpreted language optimized for scanning arbitrary text files, extracting information from those text files, and printing reports based on that information. The language is often used in shell scripting and is intended to be practical, easy to use, and efficient means of generating interactive web pages for the user. Unfortunately, many widely available freeware PERL programs (scripts) are extremely insecure. This is most readily accomplished by a malicious user substituting input to a PERL script during a POST or a GET operation. 

Consequently, the founders of PERL have developed a mechanism named TAINT that protects the system from malicious input sent from outside the program. When the data is tainted, it cannot be used in programs or functions such as eval(), system(), exec(), pipes, or popen(). The script will exit with a warning message. It is vital that if PERL is being used, the following line appear in the first line of PERL scripts:

#!/usr/local/bin/perl –T
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;WG460 - General&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;If the TAINT option cannot be used for any reason, this finding can be mitigated by the use of a third-party input validation mechanism or input validation will be included as part of the script in use. This must be documented.&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-2321r4_fix">Add the TAINT call to the PERL script.

#!/usr/local/bin/perl –T </fixtext><fix id="F-2321r4_fix" /><check system="C-30932r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>When a PERL script is invoked for execution on a UNIX server, the method which invokes the script must utilize the TAINT option.

The server’s interpreter examines the first line of the script. Typically, the first line of the script contains a reference to the script’s language and processing options.

The first line of a PERL script will be as follows:

#!/usr/local/bin/perl –T

The –T at the end of the line referenced above, tells the UNIX server to execute a PERL script using the TAINT option.

Perform the following steps:
1) grep perl httpd.conf |grep -v '#'

You should also check /apache/sysconfig.d/loadmodule.conf for PERL.

NOTE: The name of the loadmodule.conf may vary by installation.

If Apache doesn't have the mod_perl module loaded and it doesn't use PERL, this check is Not Applicable.

2) grep -i 'PerlTaintCheck' httpd.conf

If 'PerlTaintCheck on' is set, this is not a finding, and the check can stop here.

NOTE: If the PerlTaintCheck is a part of an included config file, this meets the requirement.

3) Check each individual PERL script.

From the ServerRoot directory: find . -name '*.pl'
From the DocumentRoot directory: find . -name '*.pl'

Examine the beginning of every PERL script for the -T option. If the -T option is not specified in any PERL script, this is a finding.

NOTE: This only applies to PERL scripts that are used by the web server.

NOTE: If the mod_perl module is installed and the directive “PerlTaintCheck on” in the httpd.conf is used, this satisfies the requirement.
</check-content></check></Rule></Group><Group id="V-3333"><title>WG205</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33021r1_rule" severity="medium" weight="10.0"><version>WG205 A22</version><title>The web document (home) directory must be in a separate partition from the web server’s system files.</title><description>&lt;VulnDiscussion&gt;Application partitioning enables an additional security measure by securing user traffic under one security context, while managing system and application files under another.  Web content is can be to an anonymous web user. For such an account to have access to system files of any type is a major security risk that is avoidable and desirable. Failure to partition the system files from the web site documents increases risk of attack via directory traversal, or impede web site availability due to drive space exhaustion. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;DCPA-1&lt;/IAControls&gt;</description><fixtext fixref="F-29337r1_fix">Move the web document (normally "htdocs") directory to a separate partition, other than the OS root partition and the web server’s system files.
</fixtext><fix id="F-29337r1_fix" /><check system="C-33703r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>grep "DocumentRoot" /usr/local/apache2/conf/httpd.conf 

Note each location following the DocumentRoot string, this is the configured path to the document root directory(s). 

Use the command df -k to view each document root's partition setup. 

Compare that against the results for the Operating System file systems, and against the partition for the web server system files, which is the result of the command: 

df -k /usr/local/apache2/bin

If the document root path is on the same partition as the web server system files or the OS file systems, this is a finding.
</check-content></check></Rule></Group><Group id="V-6373"><title>WG265</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33026r1_rule" severity="low" weight="10.0"><version>WG265 A22</version><title>The required DoD banner page must be displayed to authenticated users accessing a DoD private web site.</title><description>&lt;VulnDiscussion&gt;A consent banner will be in place to make prospective entrants aware that the web site they are about to enter is a DoD web site and their activity is subject to monitoring. The May 9, 2008 Policy on Use of Department of Defense (DoD) Information Systems Standard Consent Banner and User Agreement, establishes interim policy on the use of DoD information systems (http://www.dtic.mil/whs/directives/corres/pdf/DTM-08-060.pdf). The banner is mandatory and deviations are not permitted except as authorized in writing by the Deputy Assistant Secretary of Defense for Information and Identity Assurance.  The banner is required for web sites with security and access controls.  If the web site does not require authentication / authorization for use, then the banner does not need to be present.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECWM-1&lt;/IAControls&gt;</description><fixtext fixref="F-29341r1_fix">Configure  web sites that require authentication prior to admittance to display the banner text as shown, prior to web site admittance.</fixtext><fix id="F-29341r1_fix" /><check system="C-33709r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Query the IAO, the SA, and the web administrator to ensure the proper consent banner is being used in accordance with DTM-08-060.

Navigation to the web site via a browser can be used to confirm the information provided from interviewing the web staff.

The following banner page must be in place:

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

OK

[B. For Blackberries and other PDAs/PEDs with severe character limitations:]

I've read &amp; consent to terms in IS user agreem't.

If the access-controlled web site does not display this banner page in accordance with DTM-08-060 before entry, this is a finding.</check-content></check></Rule></Group><Group id="V-6531"><title>WG140</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33019r1_rule" severity="medium" weight="10.0"><version>WG140 A22</version><title>Private web servers must require certificates issued from a DoD-authorized Certificate Authority.</title><description>&lt;VulnDiscussion&gt;Web sites requiring authentication within the DoD must utilize PKI as an authentication mechanism for web users. Information systems residing behind web servers requiring authorization based on individual identity must use the identity provided by certificate-based authentication to support access control decisions.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;IATS-1, IATS-2&lt;/IAControls&gt;</description><fixtext fixref="F-29335r1_fix">Edit the httpd.conf file and set the value of SSLVerifyClient to "require".</fixtext><fix id="F-29335r1_fix" /><check system="C-33701r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>To view the SSLVerifyClient value enter the following command:

grep "SSLVerifyClient" /usr/local/apache2/conf/httpd.conf.

If the value of SSLVerifyClient is not set to “require”, this is a finding.</check-content></check></Rule></Group><Group id="V-13686"><title>WG235</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33024r1_rule" severity="high" weight="10.0"><version>WG235 A22</version><title>Web Administrators must only use encrypted connections for Document Root directory uploads.</title><description>&lt;VulnDiscussion&gt;Logging in to a web server via an unencrypted protocol or service, to upload documents to the web site, is a risk if proper encryption is not utilized to protect the data being transmitted.  An encrypted protocol or service must be used for remote access to web administration tasks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;EBRP-1, EBRU-1&lt;/IAControls&gt;</description><fixtext fixref="F-29338r1_fix">Use only secure encrypted logons and connections for uploading files to the web site.</fixtext><fix id="F-29338r1_fix" /><check system="C-33706r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Determine if there is a process for the uploading of files to the web site. This process should include the requirement for the use of a secure encrypted logon and secure encrypted connection. If the remote users are uploading files without utilizing approved encryption methods, this is a finding.</check-content></check></Rule></Group><Group id="V-13687"><title>WG237</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-14281r1_rule" severity="high" weight="10.0"><version>WG237</version><title>Remote authors or content providers are not able to upload files to the DocumentRoot directory without 
being scanned to ensure no viruses or malicious code exists.
</title><description>&lt;VulnDiscussion&gt;Remote web authors should not be able to upload files to the DocumentRoot directory structure without virus checking and checking for malicious or mobile code.  A remote web user whose agency has a Memorandum of Agreement (MOA) with the hosting agency and has submitted a DoD form 2875 (System Authorization Access Request (SAAR)) or an equivalent document will be allowed to post files to a temporary location on the server.  All posted files to this temporary location will be scanned for viruses and content checked for malicious or mobile code.  Only files free of viruses and malicious or mobile code will be posted to the appropriate DocumentRoot directory.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><fixtext fixref="F-13113r1_fix">Ensure that Anti-Virus software is installed on the system and is set to automatically scan new files that are introduced to the web server.</fixtext><fix id="F-13113r1_fix" /><check system="C-10906r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Remote web authors should not be able to upload files to the DocumentRoot directory structure without virus checking and checking for malicious or mobile code. 

Query the SA to determine if there is anti-virus software active on the server with auto-protect enabled or to determine if there is another process in place for the scanning of files / content being posted by remote authors. 

If there is no virus software on the system with auto-protect enabled or if there is not a process in place to ensure all files being posted are being virus scanned before being saved to the document root, this is a finding. </check-content></check></Rule><Rule id="SV-36699r1_rule" severity="medium" weight="10.0"><version>WG237 A22</version><title>Remote authors or content providers must have all files scanned for viruses and malicious code before uploading files to the Document Root directory.</title><description>&lt;VulnDiscussion&gt;Remote web authors should not be able to upload files to the Document Root directory structure without virus checking and checking for malicious or mobile code. A remote web user, whose agency has a Memorandum of Agreement (MOA) with the hosting agency and has submitted a DoD form 2875 (System Authorization Access Request (SAAR)) or an equivalent document, will be allowed to post files to a temporary location on the server. All posted files to this temporary location will be scanned for viruses and content checked for malicious or mobile code. Only files free of viruses and malicious or mobile code will be posted to the appropriate DocumentRoot directory.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECVP-1&lt;/IAControls&gt;</description><fixtext fixref="F-26858r1_fix">Install anti-virus software on the system and set it to automatically scan new files that are introduced to the web server.</fixtext><fix id="F-26858r1_fix" /><check system="C-30007r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Remote web authors should not be able to upload files to the Document Root directory structure without virus checking and checking for malicious or mobile code. 

Query the SA to determine if there is anti-virus software active on the server with auto-protect enabled, or if there is another process in place for the scanning of files being posted by remote authors. 

If there is no virus software on the system with auto-protect enabled, or if there is not a process in place to ensure all files being posted are being virus scanned before being saved to the document root, this is a finding.
</check-content></check></Rule></Group><Group id="V-13688"><title>WG242</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-36642r1_rule" severity="medium" weight="10.0"><version>WG242 A22</version><title>Log file data must contain required data elements.</title><description>&lt;VulnDiscussion&gt;The use of log files is a critical component of the operation of the Information Systems (IS) used within the DoD, and they can provide invaluable assistance with regard to damage assessment, causation, and the recovery of both affected components and data. They may be used to monitor accidental or intentional misuse of the (IS) and may be used by law enforcement for criminal prosecutions. The use of log files is a requirement within the DoD.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAR-1, ECAR-2, ECAR-3&lt;/IAControls&gt;</description><fixtext fixref="F-13116r2_fix">Configure the web server to ensure the log file data includes the required data elements.</fixtext><fix id="F-13116r2_fix" /><check system="C-28997r3_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>To verify the log settings:

Default UNIX location: /usr/local/apache/logs/access_log

If this directory does not exist, you can search the web server for the httpd.conf file to determine the location of the logs.

Items to be logged are as shown in this sample line in the httpd.conf file:

LogFormat "%a %A %h %H %l %m %s %t %u %U \"%{Referer}i\" " combined

If the web server is not configured to capture the required audit events for all sites and virtual directories, this is a finding.</check-content></check></Rule></Group><Group id="V-13689"><title>WG255</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-36643r1_rule" severity="medium" weight="10.0"><version>WG255 A22</version><title>Access to the web server log files must be restricted to administrators, web administrators, and auditors.</title><description>&lt;VulnDiscussion&gt;A major tool in exploring the web site use, attempted use, unusual conditions, and problems are the access and error logs. In the event of a security incident, these logs can provide the SA and the web administrator with valuable information. Because of the information that is captured in the logs, it is critical that only authorized individuals have access to the logs.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECTP-1&lt;/IAControls&gt;</description><fixtext fixref="F-26859r2_fix">To ensure the integrity of the data that is being captured in the log files, ensure that only the members of the Auditors group, Administrators, and the user assigned to run the web server software is granted permissions to read the log files.</fixtext><fix id="F-26859r2_fix" /><check system="C-30012r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Look for the presence of log files at:

/usr/local/apache/logs/access_log 

To ensure the correct location of the log files, examine the "ServerRoot" directive in the htttpd.conf file and then navigate to that directory where you will find a subdirectory for the logs. 

Determine permissions for log files, from the command line: cd to the directory where the log files are located and enter the command: 

ls –al *log and note the owner and group permissions on these files. Only the Auditors, Web Managers, Administrators, and the account that runs the web server should have permissions to the files.

If any users other than those authorized have read access to the log files, this is a finding.
</check-content></check></Rule></Group><Group id="V-13694"><title>WG342</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33030r1_rule" severity="medium" weight="10.0"><version>WG342 A22</version><title>Public web servers must use TLS if authentication is required.</title><description>&lt;VulnDiscussion&gt;TLS encryption is optional for a public web server. However, if authentication and encryption are used, then the use of TLS is required. Transactions encrypted with DoD PKI certificates are necessary when information being transferred is not intended to be accessed by all parties on the network.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECCT-1, ECCT-2&lt;/IAControls&gt;</description><fixtext fixref="F-29345r1_fix">Edit the httpd.conf file and set the SSLProtocol to TLSv1 and the SSLEngine to On.</fixtext><fix id="F-29345r1_fix" /><check system="C-33713r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Enter the following command: 

/usr/local/apache2/bin/httpd –M 

This will provide a list of all the loaded modules. Verify that the “ssl_module” is loaded. If this module is not found, this is a finding. 

After determining that the ssl module is active, enter the following command: 

grep "SSL" /usr/local/apache2/conf/httpd.conf 

Review the SSL sections of the httpd.conf file, all enabled SSLProtocol directives must be set to “TLSv1”, If not this is a finding. 

All enabled SSLEngine directives must be set to “on”, If they are not, this a finding. 

NOTE: In some cases web servers are configured in an environment to support load balancing. This configuration most likely utilizes a content switch to control traffic to the various web servers. In this situation, the TLS certificate for the web sites may be installed on the content switch vs. the individual web sites. This solution is acceptable as long as the web servers are isolated from the general population LAN. Users should not have the ability to bypass the content switch to access the web sites.
</check-content></check></Rule></Group><Group id="V-15334"><title>WG610</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-34015r1_rule" severity="low" weight="10.0"><version>WG610 A22</version><title>Web sites must utilize ports, protocols, and services according to PPSM guidelines.</title><description>&lt;VulnDiscussion&gt;Failure to comply with DoD ports, protocols, and services (PPS) requirements can result
in compromise of enclave boundary protections and/or functionality of the AIS.

The IAM will ensure web servers are configured to use only authorized PPS in accordance with the Network Infrastructure STIG, DoD Instruction 8551.1, Ports, Protocols, and Services Management (PPSM), and the associated Ports, Protocols, and Services (PPS) Assurance Category Assignments List.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;DCPP-1&lt;/IAControls&gt;</description><fixtext fixref="F-26863r2_fix">Ensure the web site enforces the use of IANA well-known ports for HTTP and HTTPS.</fixtext><fix id="F-26863r2_fix" /><check system="C-30020r2_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Review the web site to determine if HTTP and HTTPs are used in accordance with well known ports (e.g., 80 and 443) or those ports and services as registered and approved for use by the DoD PPSM. Any variation in PPS will be documented, registered, and approved by the PPSM. If not, this is a finding.</check-content></check></Rule></Group><Group id="V-26279"><title>WA00605</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33192r1_rule" severity="medium" weight="10.0"><version>WA00605 A22</version><title>Error logging must be enabled.</title><description>&lt;VulnDiscussion&gt;The server error logs are invaluable because they can also be used to identify potential problems and enable proactive remediation.  . Log data can reveal anomalous behavior such as “not found” or “unauthorized” errors that may be an evidence of attack attempts.   Failure to enable error logging can significantly reduce the ability of Web Administrators to detect or remediate problems. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAR-1&lt;/IAControls&gt;</description><fixtext fixref="F-29376r1_fix">Edit the httpd.conf file and enter the name and path to the ErrorLog.</fixtext><fix id="F-29376r1_fix" /><check system="C-33741r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Enter the following command:

grep "ErrorLog" /usr/local/apache2/conf/httpd.conf

This directive lists the name and location of the error log. 
 
If the command result lists no data, this is a finding.
</check-content></check></Rule></Group><Group id="V-26280"><title>WA00612</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33203r1_rule" severity="medium" weight="10.0"><version>WA00612 A22</version><title>The sites error logs must log the correct format.</title><description>&lt;VulnDiscussion&gt;The server error logs are invaluable because they can also be used to identify potential problems and enable proactive remediation. Log data can reveal anomalous behavior such as “not found” or “unauthorized” errors that may be an evidence of attack attempts. Failure to enable error logging can significantly reduce the ability of Web Administrators to detect or remediate problems. The LogFormat directive defines the format and information to be included in the access log entries.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAR-1, ECAR-2&lt;/IAControls&gt;</description><fixtext fixref="F-29379r1_fix">Edit the httpd.conf file and add LogFormat "%a %A %h %H %l %m %s %t %u %U \"%{Referer}i\" " combined</fixtext><fix id="F-29379r1_fix" /><check system="C-33744r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Enter the following command:

grep "LogFormat" /usr/local/apache2/conf/httpd.conf.

The command should return the following value: 

LogFormat "%a %A %h %H %l %m %s %t %u %U \"%{Referer}i\" " combined.

If the above value is not returned, this is a finding. </check-content></check></Rule></Group><Group id="V-26281"><title>WA00615</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33206r1_rule" severity="medium" weight="10.0"><version>WA00615 A22</version><title>System logging must be enabled.</title><description>&lt;VulnDiscussion&gt;The server error logs are invaluable because they can also be used to identify potential problems and enable proactive remediation. Log data can reveal anomalous behavior such as “not found” or “unauthorized” errors that may be an evidence of attack attempts.   Failure to enable error logging can significantly reduce the ability of Web Administrators to detect or remediate problems. The CustomLog directive specifies the log file, syslog facility, or piped logging utility.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAR-1&lt;/IAControls&gt;</description><fixtext fixref="F-29381r1_fix">Edit the httpd.conf file and enter the name, path and level for the CustomLog.</fixtext><fix id="F-29381r1_fix" /><check system="C-33746r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Enter the following command:

grep "CustomLog" /usr/local/apache2/conf/httpd.conf

The command should return the following value:.

CustomLog "Logs/access_log" common

If the above value is not returned, this is a finding.
</check-content></check></Rule></Group><Group id="V-26282"><title>WA00620</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-33207r1_rule" severity="medium" weight="10.0"><version>WA00620 A22</version><title>The LogLevel directive must be enabled.</title><description>&lt;VulnDiscussion&gt;The server error logs are invaluable because they can also be used to identify potential problems and enable proactive remediation. Log data can reveal anomalous behavior such as “not found” or “unauthorized” errors that may be an evidence of attack attempts. Failure to enable error logging can significantly reduce the ability of Web Administrators to detect or remediate problems. While the ErrorLog directive configures the error log file name, the LogLevel directive is used to configure the severity level for the error logs. The log level values are the standard syslog levels: emerg, alert, crit, error, warn, notice, info and debug.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAR-1&lt;/IAControls&gt;</description><fixtext fixref="F-29385r1_fix">Edit the httpd.conf file and add the value LogLevel warn.</fixtext><fix id="F-29385r1_fix" /><check system="C-33749r1_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Enter the following command:

grep "LogLevel" /usr/local/apache2/conf/httpd.conf

The command should return the following value: 

LogLevel warn

If the above value is not returned, this is a finding.
Note:  If LogLevel is set to error, crit, alert, or emerg which are higher thresholds this is not a finding.
</check-content></check></Rule><Rule id="SV-28476r1_rule" severity="medium" weight="10.0"><version>WG340</version><title>A Private web server is not using TLS.</title><description>&lt;VulnDiscussion&gt;The following discussion is predicated upon an understanding of the DoD Internet DMZ STIG, 

Definitions:
Private Web Server:
DoD 8520.2, E2.1.12 states:
For unclassified networks, a DoD private web server is any DoD-owned, operated, or controlled web server providing access to sensitive information that has not been reviewed and approved for release in accordance with DoD Directive 5230.9 (reference (q)) and DoD Instruction 5230.29 (reference (r)). For Secret Internet Protocol Router Network and other classified networks that are not accessible to the public, a DoD private web server is any server that provides access to information that requires need-to-know control or compartmentation.

JTF-GNO, CTO-08-012 defines private resources i.e. private web server as follows:
Private resources are NIPRNet services and applications that should not be accessible from the Internet at any time….Their defining characteristic is that they should only be reached through the NIPRNet, and never from the Internet.  

Transport Layer Security (TLS) encryption is a required security setting for a private web server. This check precludes the possibility that a valid certificate has been obtained, but TLS has not been activated or is not being used. Transactions encrypted with trusted certificates are necessary when the information being transferred is not intended to be accessed by all parties on the network. To the extent that this standard applies, this check is valid for the SIPRNet also.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SecurityOverrideGuidance&gt;&lt;/SecurityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Web Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECCT-1, ECCT-2&lt;/IAControls&gt;</description><fixtext fixref="F-2311r5_fix">A private web server must use TLS.  Obtain a server certificate from a .mil Certificate Authority or approved DoD ECA.

From the Internet Service Manager (this selection starts the Microsoft Management Console, MMC) 

&gt;&gt; Select web site to be examined; Select the Properties of the web site in question &gt;&gt; Select Directory Security tab and choose the Edit button in the Secure Communications section.  

Ensure the Require secure channel (SSL) is selected and also if 128-bit encryption is required.

The version of SSL also needs to set to require SSL V3.1

The following registry keys need to exist and be set to not allow anything lower than SSL V3.1 / TLS.  This can be accomplished by ensuring the following value exists in each of the keys:

Enabled REG_DWORD     0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD  1, to enable SSL V3.1 / TLS.
</fixtext><fix id="F-2311r5_fix" /><check system="C-2729r5_chk"><check-content-ref name="M" href="VMS_XCCDF_Benchmark_APACHE SITE 2.2 UNIX.xml" /><check-content>Provided Apache-SSL or mod_ssl are being used. Find and open the httpd.conf file in a text editor or use command line tools to open the file.

NOTE1: These directives are in the context of the “server config” or “virtual host” they may be found in the httpd.conf file, or a virtual host config file.  This may also include a config file that has bee “Included” via the httpd.conf or other config file.

Look for the existence of the SSLProtocol directive. This directive can be used to control the SSL protocol flavors mod_ssl should use when establishing its server environment. Clients then can only connect with one of the provided protocols.

SSLProtocol TLSv1 – is the required setting for this check.  If SSLProtocol is not set to TLSv1 this would be a finding.

Also, look for the existence of the SSLEngine directive.  This directive toggles the usage of the SSL/TLS Protocol Engine. This is usually used inside a &lt;VirtualHost&gt; section to enable SSL/TLS for a particular virtual host. By default the SSL/TLS Protocol Engine is disabled for both the main server and all configured virtual hosts. 

“SSLEngine on” - is the required setting for this check.  If it is not set to on or does not exist, this would be a finding.

Both the SSLEngine and SSLProtocol directives must be set correctly or this is a finding.

NOTE2: In some cases the web servers are configured in an environment to support load balancing. This configuration most likly utilizes a content switch to contol traffic to the various web servers. In this situration, the SSL certificated for the web sites may be installed on the content switch vs, the individual web sites. This solution is acceptable as long as the web servers are isolated from the general population LAN. We don't want users to have the ability to bypass the content switch to access the web sites.


</check-content></check></Rule></Group></Benchmark>